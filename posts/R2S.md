---
title: "R2S"
date: "2020-01-02"
---

前段时间购入了一个 R2S，主要为了解决两个问题

1. 需要一个透明代理，不想在每个设备上启动代理。
2. xbox 需要使用加速器。

R2S 本身不具备无线功能，所以需要准备一个普通路由并开启桥接充当 AP。

![Untitled (Draft).png](/images/R2s.png)

如上图所示，R2S 充当路由器，普通路由充当 AP + 交换机。

## 安装

首先要给 R2S 装上 OpenWRT，可以到 GitHub 下的 [#r2s](https://github.com/topics/r2s) 标签下选择你喜欢的固件。每个项目都有对应的安装教程，实际上都是一样的，用 [balenaetcher](https://www.balena.io/etcher) 烧录即可，别忘了准备读卡器。

为了给 xbox 加速，安装 uu OpenWRT 的脚本，并在手机上完成配置。（这里居然没有电脑 or 网页端可配置）

## 透明代理

安装或使用固件自带的 OpenClash。

主要有以下一些注意点：

- 初次使用请在版本更新完成更新，不然可能会在初次启动时出现错误。
- 推荐使用 Fake-IP TUN 混合。
- 推荐打开 DNS 劫持，并配置 DNS。
- 如果你想使用 qBittorrent 或类似的 bit 下载工具，请注意在客户端配置 socks 代理。

<aside>
💡 这里实际上没有解决 IPv6 的问题，由于没有公网 IPv4 的地址，BT 不启用 IPv6 会损失不少流量。

</aside>

- 推荐使用「服务器与策略组管理」代替配置文件管理，主要步骤如下：
  - 导入/订阅 一个/多个 配置文件/代理链接。
  - 点击读取配置，随后清空组策略配置，点击保存配置。
  - 勾选一件生成配置文件、混合节点、保留配置。
  - 再次点击读取配置，随后点击应用即可。
  ***
  - 对于多个配置文件，只需切换后点击读取配置即可获得相应的节点。
  - 使用该方法主要是将策略组和服务器分开管理，策略组使用外链订阅并保持更新，同时可以使用多个配置文件中的的服务器。
- 注意开启 GEOIP 的自动更新。

这样差不多就完成配置了，可以愉快的使用透明代理了，只需要连上 Wi-Fi 或插上网线即可愉快的访问互联网了。

## 注意点

- uu 和 openclash 不会发生冲突，注意先启用 clash 再启用 uu。
- uu 的实现原理应该是接管 xbox 的所有流量，将其定向至一个国内的中转，随后在该中转上实现了对应规则的转发。所以其转发规则并非在本地实现，出去的流量只有一个对应中转的国内 IP。
  - 这样的规则带来了一些问题，比如我想开着 uu 加速同时使用 clash 代理 Apple Music。还没找到解决该问题的方法。
- 给 R2S 准备一个合格的电源，确保能 5V2A。
- 另外其实我非常想启用 IPv6，后续启用了再来记录坑吧。
